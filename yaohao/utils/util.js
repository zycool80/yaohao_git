'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _typeof2 = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

exports.parseTime = parseTime;
exports.timeAgo = timeAgo;
exports._typeof = _typeof;
exports.encodeQuery = encodeQuery;
exports.logInfo = logInfo;

var _underscore = require('./../npm/underscore/underscore.js');

var _underscore2 = _interopRequireDefault(_underscore);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var join = function join(array, separator) {
  var out = '';
  var total = array.length;
  if (total == 1) {
    out = array[0];
  } else {
    _underscore2.default.each(array, function (item, index) {
      if (index < total - 1) {
        out += item + separator;
      } else {
        out += item;
      }
    });
  }
  return out;
};

function parseTime(time, cFormat) {
  if (arguments.length === 0) {
    return null;
  }
  if ((time + '').length === 10) {
    time = +time * 1000;
  }
  var format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}';
  var date = void 0;
  if ((typeof time === 'undefined' ? 'undefined' : _typeof2(time)) === 'object') {
    date = time;
  } else {
    date = new Date(parseInt(time));
  }
  var formatObj = {
    y: date.getFullYear(),
    m: date.getMonth() + 1,
    d: date.getDate(),
    h: date.getHours(),
    i: date.getMinutes(),
    s: date.getSeconds(),
    a: date.getDay()
  };
  return format.replace(/{(y|m|d|h|i|s|a)+}/g, function (result, key) {
    var value = formatObj[key];
    if (key === 'a') return ['一', '二', '三', '四', '五', '六', '日'][value - 1];
    if (result.length > 0 && value < 10) {
      value = '0' + value;
    }
    return value || 0;
  });
}

function getTodayStart() {
  var now = new Date();
  now.setHours(0);
  now.setMinutes(0);
  now.setSeconds(0);
  now.setMilliseconds(0);
  return Date.parse(now) / 1000;
}

function timeAgo(time) {
  var tmp = time.replace('T', ' ').replace(/-/g, '/');
  var data = new Date(tmp).getTime() / 1000;
  var between = Date.now() / 1000 - data;
  var todayStart = getTodayStart();

  if (data > todayStart) {
    if (between < 60) {
      return '刚刚';
    } else if (between < 3600) {
      return ~~(between / 60) + ' 分钟前';
    } else {
      return '今天 ' + parseTime(data, '{h}:{i}');
    }
  } else if (todayStart - data < 86400) {
    return '昨天 ' + parseTime(data, '{h}:{i}');
  } else {
    return parseTime(data, '{m}-{d} {h}:{i}');
  }
}

function _typeof(obj) {
  var class2type = {};
  "Boolean Number String Function Array Date RegExp Object Error".split(" ").forEach(function (e, i) {
    class2type["[object " + e + "]"] = e.toLowerCase();
  });
  if (obj == null) {
    return String(obj);
  }
  return (typeof obj === 'undefined' ? 'undefined' : _typeof2(obj)) === "object" || typeof obj === "function" ? class2type[class2type.toString.call(obj)] || "object" : typeof obj === 'undefined' ? 'undefined' : _typeof2(obj);
}

function encodeQuery(obj) {
  var out = [];
  _underscore2.default.each(obj, function (value, key) {
    out.push(key + '=' + value);
  });
  if (out.length) {
    return join(out, '&');
  }
  return '';
}

function logInfo(info, prefix) {
  prefix = prefix ? prefix : '';
  console.log(prefix + ' %c' + info + ' ', "color:red");
}
function guid() {
  function s4() {
    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);
  }
  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();
}

module.exports = {
  join: join,
  _typeof: _typeof,
  encodeQuery: encodeQuery,
  logInfo: logInfo,
  timeAgo: timeAgo,
  guid: guid,
  parseTime: parseTime
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWwuanMiXSwibmFtZXMiOlsicGFyc2VUaW1lIiwidGltZUFnbyIsIl90eXBlb2YiLCJlbmNvZGVRdWVyeSIsImxvZ0luZm8iLCJqb2luIiwiYXJyYXkiLCJzZXBhcmF0b3IiLCJvdXQiLCJ0b3RhbCIsImxlbmd0aCIsIl8iLCJlYWNoIiwiaXRlbSIsImluZGV4IiwidGltZSIsImNGb3JtYXQiLCJhcmd1bWVudHMiLCJmb3JtYXQiLCJkYXRlIiwiRGF0ZSIsInBhcnNlSW50IiwiZm9ybWF0T2JqIiwieSIsImdldEZ1bGxZZWFyIiwibSIsImdldE1vbnRoIiwiZCIsImdldERhdGUiLCJoIiwiZ2V0SG91cnMiLCJpIiwiZ2V0TWludXRlcyIsInMiLCJnZXRTZWNvbmRzIiwiYSIsImdldERheSIsInJlcGxhY2UiLCJyZXN1bHQiLCJrZXkiLCJ2YWx1ZSIsImdldFRvZGF5U3RhcnQiLCJub3ciLCJzZXRIb3VycyIsInNldE1pbnV0ZXMiLCJzZXRTZWNvbmRzIiwic2V0TWlsbGlzZWNvbmRzIiwicGFyc2UiLCJ0bXAiLCJkYXRhIiwiZ2V0VGltZSIsImJldHdlZW4iLCJ0b2RheVN0YXJ0Iiwib2JqIiwiY2xhc3MydHlwZSIsInNwbGl0IiwiZm9yRWFjaCIsImUiLCJ0b0xvd2VyQ2FzZSIsIlN0cmluZyIsInRvU3RyaW5nIiwiY2FsbCIsInB1c2giLCJpbmZvIiwicHJlZml4IiwiY29uc29sZSIsImxvZyIsImd1aWQiLCJzNCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN1YnN0cmluZyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O1FBbUJnQkEsUyxHQUFBQSxTO1FBMENBQyxPLEdBQUFBLE87UUFxQkFDLE8sR0FBQUEsTztRQWFBQyxXLEdBQUFBLFc7UUFXQUMsTyxHQUFBQSxPOztBQTFHaEI7Ozs7OztBQUVBLElBQU1DLE9BQU8sU0FBUEEsSUFBTyxDQUFDQyxLQUFELEVBQVFDLFNBQVIsRUFBb0I7QUFDL0IsTUFBSUMsTUFB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QUFPeUMsR0FBUCxFQUFZLFVBQUNiLEtBQUQsRUFBUUQsR0FBUixFQUFjO0FBQ3hCL0IsUUFBSXNELElBQUosQ0FBWXZCLEdBQVosU0FBbUJDLEtBQW5CO0FBQ0QsR0FGRDtBQUdBLE1BQUloQyxJQUFJRSxNQUFSLEVBQWdCO0FBQ2QsV0FBT0wsS0FBS0csR0FBTCxFQUFVLEdBQVYsQ0FBUDtBQUNEO0FBQ0QsU0FBTyxFQUFQO0FBQ0Q7O0FBRU0sU0FBU0osT0FBVCxDQUFpQjJELElBQWpCLEVBQXVCQyxNQUF2QixFQUErQjtBQUNwQ0EsV0FBU0EsU0FBU0EsTUFBVCxHQUFrQixFQUEzQjtBQUNBQyxVQUFRQyxHQUFSLENBQWVGLE1BQWYsV0FBMkJELElBQTNCLFFBQW1DLFdBQW5DO0FBQ0Q7QUFDRCxTQUFTSSxJQUFULEdBQWdCO0FBQ2QsV0FBU0MsRUFBVCxHQUFjO0FBQ1osV0FBT0MsS0FBS0MsS0FBTCxDQUFXLENBQUMsSUFBSUQsS0FBS0UsTUFBTCxFQUFMLElBQXNCLE9BQWpDLEVBQ0pYLFFBREksQ0FDSyxFQURMLEVBRUpZLFNBRkksQ0FFTSxDQUZOLENBQVA7QUFHRDtBQUNELFNBQU9KLE9BQU9BLElBQVAsR0FBYyxHQUFkLEdBQW9CQSxJQUFwQixHQUEyQixHQUEzQixHQUFpQ0EsSUFBakMsR0FBd0MsR0FBeEMsR0FDTEEsSUFESyxHQUNFLEdBREYsR0FDUUEsSUFEUixHQUNlQSxJQURmLEdBQ3NCQSxJQUQ3QjtBQUVEOztBQUVESyxPQUFPQyxPQUFQLEdBQWlCO0FBQ2ZyRSxRQUFNQSxJQURTO0FBRWZILFdBQVNBLE9BRk07QUFHZkMsZUFBYUEsV0FIRTtBQUlmQyxXQUFTQSxPQUpNO0FBS2ZILFdBQVNBLE9BTE07QUFNZmtFLFFBQU1BLElBTlM7QUFPZm5FLGFBQVdBO0FBUEksQ0FBakIiLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ3VuZGVyc2NvcmUnXG5cbmNvbnN0IGpvaW4gPSAoYXJyYXksIHNlcGFyYXRvcik9PntcbiAgdmFyIG91dCA9ICcnXG4gIHZhciB0b3RhbCA9IGFycmF5Lmxlbmd0aFxuICBpZiAodG90YWwgPT0gMSkge1xuICAgIG91dCA9IGFycmF5WzBdXG4gIH0gZWxzZSB7XG4gICAgXy5lYWNoKGFycmF5LCAoaXRlbSwgaW5kZXgpPT57XG4gICAgICBpZiAoaW5kZXggPCB0b3RhbCAtIDEpIHtcbiAgICAgICAgb3V0ICs9IGl0ZW0gKyBzZXBhcmF0b3JcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG91dCArPSBpdGVtXG4gICAgICB9XG4gICAgfSlcbiAgfVxuICByZXR1cm4gb3V0XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJzZVRpbWUodGltZSwgY0Zvcm1hdCkge1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiBudWxsXG4gIH1cbiAgaWYgKCh0aW1lICsgJycpLmxlbmd0aCA9PT0gMTApIHtcbiAgICB0aW1lID0gK3RpbWUgKiAxMDAwXG4gIH1cbiAgY29uc3QgZm9ybWF0ID0gY0Zvcm1hdCB8fCAne3l9LXttfS17ZH0ge2h9OntpfTp7c30nXG4gIGxldCBkYXRlXG4gIGlmICh0eXBlb2YgdGltZSA9PT0gJ29iamVjdCcpIHtcbiAgICBkYXRlID0gdGltZVxuICB9IGVsc2Uge1xuICAgIGRhdGUgPSBuZXcgRGF0ZShwYXJzZUludCh0aW1lKSlcbiAgfVxuICBjb25zdCBmb3JtYXRPYmogPSB7XG4gICAgeTogZGF0ZS5nZXRGdWxsWWVhcigpLFxuICAgIG06IGRhdGUuZ2V0TW9udGgoKSArIDEsXG4gICAgZDogZGF0ZS5nZXREYXRlKCksXG4gICAgaDogZGF0ZS5nZXRIb3VycygpLFxuICAgIGk6IGRhdGUuZ2V0TWludXRlcygpLFxuICAgIHM6IGRhdGUuZ2V0U2Vjb25kcygpLFxuICAgIGE6IGRhdGUuZ2V0RGF5KClcbiAgfVxuICByZXR1cm4gZm9ybWF0LnJlcGxhY2UoL3soeXxtfGR8aHxpfHN8YSkrfS9nLCAocmVzdWx0LCBrZXkpID0+IHtcbiAgICBsZXQgdmFsdWUgPSBmb3JtYXRPYmpba2V5XVxuICAgIGlmIChrZXkgPT09ICdhJykgcmV0dXJuIFsn5LiAJywgJ+S6jCcsICfkuIknLCAn5ZubJywgJ+S6lCcsICflha0nLCAn5pelJ11bdmFsdWUgLSAxXVxuICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCAmJiB2YWx1ZSA8IDEwKSB7XG4gICAgICB2YWx1ZSA9ICcwJyArIHZhbHVlXG4gICAgfVxuICAgIHJldHVybiB2YWx1ZSB8fCAwXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGdldFRvZGF5U3RhcnQoKSB7XG4gIHZhciBub3cgPSBuZXcgRGF0ZSgpXG4gIG5vdy5zZXRIb3VycygwKVxuICBub3cuc2V0TWludXRlcygwKVxuICBub3cuc2V0U2Vjb25kcygwKVxuICBub3cuc2V0TWlsbGlzZWNvbmRzKDApXG4gIHJldHVybiBEYXRlLnBhcnNlKG5vdykvMTAwMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRpbWVBZ28odGltZSkge1xuICB2YXIgdG1wID0gdGltZS5yZXBsYWNlKCdUJywgJyAnKS5yZXBsYWNlKC8tL2csICcvJylcbiAgdmFyIGRhdGEgPSAobmV3IERhdGUodG1wKSkuZ2V0VGltZSgpLzEwMDBcbiAgY29uc3QgYmV0d2VlbiA9IERhdGUubm93KCkgLyAxMDAwIC0gIGRhdGFcbiAgdmFyIHRvZGF5U3RhcnQgPSBnZXRUb2RheVN0YXJ0KClcblxuICBpZiAoZGF0YSA+IHRvZGF5U3RhcnQpIHtcbiAgICBpZiAoYmV0d2VlbiA8IDYwKSB7XG4gICAgICByZXR1cm4gJ+WImuWImidcbiAgICB9IGVsc2UgaWYgKGJldHdlZW4gPCAzNjAwKSB7XG4gICAgICByZXR1cm4gfn4oYmV0d2VlbiAvIDYwKSArICcg5YiG6ZKf5YmNJ1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJ+S7iuWkqSAnICsgcGFyc2VUaW1lKGRhdGEsICd7aH06e2l9JylcbiAgICB9XG4gIH0gZWxzZSBpZiAodG9kYXlTdGFydCAtIGRhdGEgPCA4NjQwMCkge1xuICAgIHJldHVybiAn5pio5aSpICcgKyBwYXJzZVRpbWUoZGF0YSwgJ3tofTp7aX0nKVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBwYXJzZVRpbWUoZGF0YSwgJ3ttfS17ZH0ge2h9OntpfScpXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7XG4gIHZhciBjbGFzczJ0eXBlID0ge30gO1xuICBcIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3JcIi5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbihlLGkpe1xuICAgIGNsYXNzMnR5cGVbIFwiW29iamVjdCBcIiArIGUgKyBcIl1cIiBdID0gZS50b0xvd2VyQ2FzZSgpO1xuICB9KSA7XG4gIGlmICggb2JqID09IG51bGwgKXtcbiAgICByZXR1cm4gU3RyaW5nKCBvYmogKTtcbiAgfVxuICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIgP1xuICAgIGNsYXNzMnR5cGVbIGNsYXNzMnR5cGUudG9TdHJpbmcuY2FsbChvYmopIF0gfHwgXCJvYmplY3RcIiA6XG4gICAgdHlwZW9mIG9iajtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuY29kZVF1ZXJ5KG9iaikge1xuICB2YXIgb3V0ID0gW11cbiAgXy5lYWNoKG9iaiwgKHZhbHVlLCBrZXkpPT57XG4gICAgb3V0LnB1c2goYCR7a2V5fT0ke3ZhbHVlfWApXG4gIH0pXG4gIGlmIChvdXQubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGpvaW4ob3V0LCAnJicpXG4gIH1cbiAgcmV0dXJuICcnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dJbmZvKGluZm8sIHByZWZpeCkge1xuICBwcmVmaXggPSBwcmVmaXggPyBwcmVmaXggOiAnJ1xuICBjb25zb2xlLmxvZyhgJHtwcmVmaXh9ICVjJHtpbmZvfSBgLFwiY29sb3I6cmVkXCIpO1xufVxuZnVuY3Rpb24gZ3VpZCgpIHtcbiAgZnVuY3Rpb24gczQoKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAuc3Vic3RyaW5nKDEpO1xuICB9XG4gIHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICtcbiAgICBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgam9pbjogam9pbixcbiAgX3R5cGVvZjogX3R5cGVvZixcbiAgZW5jb2RlUXVlcnk6IGVuY29kZVF1ZXJ5LFxuICBsb2dJbmZvOiBsb2dJbmZvLFxuICB0aW1lQWdvOiB0aW1lQWdvLFxuICBndWlkOiBndWlkLFxuICBwYXJzZVRpbWU6IHBhcnNlVGltZVxufVxuIl19